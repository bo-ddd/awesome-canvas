!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports["awesome-canvas"]=e():t["awesome-canvas"]=e()}(self,(()=>(()=>{"use strict";var t,e,i,n,r,h={d:(t,e)=>{for(var i in e)h.o(e,i)&&!h.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},s={};h.r(s),h.d(s,{Canvas:()=>a,CanvasElement:()=>o}),function(t){t.Block="block",t.Flex="flex"}(t||(t={})),function(t){t.View="view",t.Canvas="canvas",t.Text="text"}(e||(e={})),function(t){t.FlexStart="flex-start",t.Center="center",t.FlexEnd="flex-end",t.Stretch="stretch"}(i||(i={})),function(t){t.FlexStart="flex-start",t.Center="center",t.FlexEnd="flex-end",t.SpaceBetween="space-between",t.SpaceAround="space-around"}(n||(n={})),function(t){t.Row="row",t.Column="column",t.RowReverse="row-reverse",t.ColumnReverse="column-reverse"}(r||(r={}));var o=function(){function h(e){this.id=null,this.parent=null,this.previousSibling=null,this.nextSibling=null,this.alignItems=i.FlexStart,this.index=null,this.display=t.Block,this.justifyContent=n.FlexStart,this.flexDirection=r.Row,this.fillStyle="#000",this.nodeType=e,this.children=[],this.parent=null,this._width=0,this._height=0,this._textContent="",this._fontSize=8,this.previousSibling=null,this.nextSibling=null}return Object.defineProperty(h.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){this._fontSize=t,this._width=this.getTextWidth()},enumerable:!1,configurable:!0}),h.prototype.getTextWidth=function(){return this.getMeasureText().width},h.prototype.getMeasureText=function(){var t=document.createElement("canvas").getContext("2d");return t.font=this.font,t.fillText(this._textContent,0,0),t.measureText(this._textContent)},Object.defineProperty(h.prototype,"font",{get:function(){return"".concat(this.fontSize,"px Arial")},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"textContent",{get:function(){return this._textContent},set:function(t){this._textContent=t;var e=document.createElement("canvas").getContext("2d");e.font=this.font,e.fillText(this._textContent,0,0),this._width=e.measureText(t).width},enumerable:!1,configurable:!0}),h.prototype.getTextHeight=function(){var t=document.createElement("canvas").getContext("2d");t.font=this.font;var e=t.measureText(this._textContent);return e.fontBoundingBoxAscent,e.fontBoundingBoxDescent,e.actualBoundingBoxAscent+e.actualBoundingBoxDescent},Object.defineProperty(h.prototype,"startX",{get:function(){var e=0,h=this.parent,s=h.alignItems,o=h.justifyContent,a=h.display,l=h.flexDirection;if(a===t.Block)e=this.parent.startX;else if(a===t.Flex)if(l===r.Row){switch(s){case i.FlexStart:e=this.parent.startX;break;case i.Center:e=this.parent.startX+this.parent.width/2-this.width/2;break;case i.FlexEnd:e=this.parent.startX+this.parent.width-this.width}if(o===n.SpaceBetween){var c=this.parent.width/(this.parent.children.length+1);e=this.parent.startX+c*(this.index+1)-this.width/2}}else if(l===r.Column)switch(s){case i.FlexStart:e=this.parent.startX;break;case i.Center:e=this.parent.startX+this.parent.width/2-this.width/2}return e},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"width",{get:function(){return this._width||this.nodeType===e.View&&(this._width=this.parent.width),this._width},set:function(t){this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"startY",{get:function(){var h=this.previousSibling,s=0,o=this.parent,a=o.display,l=o.justifyContent,c=o.alignItems,u=o.flexDirection;if(a===t.Block)s=h?h.startY+h.height:this.parent.startY,this.nodeType===e.Text&&(s+=this.height);else if(a===t.Flex)if(u===r.Row)c===i.Center&&(this.nodeType===e.Text?s+=this.parent.height/2+this.height/2:s+=this.parent.height/2-this.height/2),l===n.SpaceBetween&&(s=this.parent.startY);else if(u===r.Column)switch(c){case i.FlexStart:h?s=h.startY+h.height:this.parent&&(s=this.parent.startY),this.nodeType==e.Text&&(s+=this.height);break;case i.Center:if(h)if(this.nodeType===e.Text){var p=this.parent.children.find((function(t){return t.nodeType===e.Text}));s=h.startY+this.height,p===this&&(s+=h.height)}else s=h.startY+h.height;else{var f=this.parent.children.reduce((function(t,e){return t+e.height}),0),d=(this.parent.height-f)/2;s=this.parent.startY-d}}return s},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"height",{get:function(){if(this.nodeType===e.Text)return this._height=this.getTextHeight(),this._height;if(!this._height){var i=this.children;if(i.length&&this.display===t.Flex)switch(this.flexDirection){case r.Row:this._height=Math.max.apply(Math,i.map((function(t){return t.height})));break;case r.Column:this._height=i.reduce((function(t,e){return t+e.height}),0)}}return this._height},set:function(t){if(this.nodeType===e.Text)throw new Error("text节点不能设置高度");this._height=t},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"center",{get:function(){return{x:this.startX+this.width/2,y:this.startY+this.height/2}},enumerable:!1,configurable:!0}),h.prototype.appendChild=function(t){var e,i=this;Array.isArray(t)?((e=this.children).push.apply(e,t),t.forEach((function(t){t.parent=i}))):(this.children.push(t),t.parent=this),this.children.forEach((function(t,e){var n,r;t.previousSibling=null!==(n=i.children[e-1])&&void 0!==n?n:null,t.nextSibling=null!==(r=i.children[e+1])&&void 0!==r?r:null,t.index=e}))},h}();const a=function(){function i(){this.nodeType=e.Canvas,this.children=[],this.startX=0,this.startY=0,this.display=t.Block,this.element=document.createElement("canvas"),this.ctx=this.element.getContext("2d"),this.width=this.element.width=500,this.height=this.element.height=500}return i.prototype.createElement=function(t){return new o(t)},i.prototype.appendChild=function(t){var e=this;o.prototype.appendChild.apply(this,[t]),this.children.forEach((function(t){e.draw(t)}))},i.prototype.draw=function(t){var e=this;if(this.ctx.beginPath(),this.ctx.fillStyle=t.fillStyle,"text"===t.nodeType){this.ctx.textAlign=t.textAlign,this.ctx.font=t.font,this.ctx.fillText(t.textContent,t.startX,t.startY);var i=this.ctx.measureText(t.textContent).width;t.width=i}"view"===t.nodeType&&(t.fillStyle?this.ctx.fillRect(t.startX,t.startY,t.width,t.height):this.ctx.rect(t.startX,t.startY,t.width,t.height)),this.ctx.closePath(),t.children.length&&t.children.forEach((function(t){e.draw(t)}))},i}();return s})()));